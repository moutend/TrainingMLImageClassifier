# Training MLImageClassifier

MLImageClassifierを使用してiPhone上で画像分類モデルを訓練および推論するサンプルアプリです。

このアプリは風景写真から東西南北を推定します。屋内の写真でもある程度は動作しますが、例えば四方を同じ色の壁紙で囲まれた部屋の場合、写真から特徴を学習できないため方角をうまく判別できない恐れがあります。

## システム要件

- iOS 15.0+
- Xcode 14.2+

## アプリの使い方

アプリを起動すると「Classify」と「Train」というボタンが現れます。まずはモデルを訓練するため「Train」を選択してください。

次の画面には東西南北それぞれの訓練データを作成する画面が表示されます。ボタンを押すとカメラのプレビュー画面が表示されます。

訓練データの撮影中は、iPhoneを縦向きに持ってください。また、前後左右に少し傾けたり、小刻みに手を動かしたりすることで、より汎化性能の高いモデルになります。

東西南北すべての訓練データが作成できたら「Next」ボタンを押してください。デバイスの性能や訓練データの内容にもよりますが、例えばiPhone 13の場合およそ30秒ほどで訓練が完了します。

訓練が完了したら最初の画面に戻り「Classify」ボタンを押してください。次の画面で「Compile Image Classifier」ボタンを押すと、先ほど作成したモデルがコンパイルされます。iPhone 13の場合、30 msほどでコンパイルは完了します。

モデルのコンパイルが完了したら、画像の分類を試してみましょう。画像の分類は1秒ごとに行われ、結果が画面の下部に表示されます。

## ライセンス

MIT
